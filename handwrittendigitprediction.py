# -*- coding: utf-8 -*-
"""Handwrittendigitprediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1vQFhV8OULWcC6DKJq48_kIkg02c0AKXc

# **Hand Written Digit Prediction- Classification Analysis**

**The digits dataset consists of 8x8 pixel images of didgits.The images attribute of the dataset stores 8x8 arrays of grayscale values each image.We will use these arrays to visualize the first 4 images. The target attribute of the dataset stores the digit each image represents**

# **Import Library**
"""

import pandas as pd

import numpy as np

import matplotlib.pyplot as plt

"""# **Import Data**"""

from sklearn.datasets import load_digits

df = load_digits()

_,axes = plt.subplots(nrows=1, ncols=4, figsize=(10,3))
for ax,image, label in zip(axes,df.images, df.target):
  ax.set_axis_off()
  ax.imshow(image, cmap=plt.cm.gray_r, interpolation="nearest")
  ax.set_title("Training: %i" % label)

"""# **Data Preprocessing**

**Flatten Image**

![OIP.jpeg](data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAAAAAAAD/4QAuRXhpZgAATU0AKgAAAAgAAkAAAAMAAAABAE0AAEABAAEAAAABAAAAAAAAAAD/2wBDAAoHBwkHBgoJCAkLCwoMDxkQDw4ODx4WFxIZJCAmJSMgIyIoLTkwKCo2KyIjMkQyNjs9QEBAJjBGS0U+Sjk/QD3/2wBDAQsLCw8NDx0QEB09KSMpPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT3/wAARCAEEAdoDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD2WiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACkkJEbEdQDilpCAwIPQjFAHCWnirVotKtpZ0V7ybaGWbakca+XuVs5XJk5OcgAggAlebupeK76wtrudobdfKmaOKIqx3bI953MWABOcDGc44Bzx032G3/wCeY/M0v2GD/nmPzNLUq0e7MiHWp531eEhEktYy8Xljdxg4LHP3sj7pAI9xzWXb6tqGn2dlPdzT7pLNpGFxtkBYtCoJ27QAN56kYySTiuuitooSTGgUnrzUuBTJduhw6+J9Uubc3C3Fnaq0NrIEeIttDTNHI2d3K4APsCOe5uJ4n1GeW5SO2tl2XCwJvf5kJmEeWUNnBUlgcDsOetdXgHqBS4HJwOetAFDR7yW/05J51VZd7owTOCVcrkZ7Hbn8e9X6KKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACqWpapb6TAs10WCM2wbVLc4z2+hq7XNeOP+QXb/8AXwP/AEFqipLli2iZNpNk3/CZ6X6z/wDflqP+Ez0v1n/78tXC0V5/1yfZHP7aR3X/AAmel+s//flqP+Ez0v1n/wC/LVwtFH1yfZB7aR3X/CZ6X6z/APflqP8AhM9L9Z/+/LVwtFH1yfZB7aR3X/CZ6X6z/wDflqP+Ez0v1n/78tXC0UfXJ9kHtpHdf8JnpfrP/wB+Wo/4TPS/Wf8A78tXC0UfXJ9kHtpHdf8ACZaX6z/9+Wq7pmu2mrySR2pk3RgMwdCvX/8AVXnFdL4H/wCP+8/65J/M1pRxM5zUWVCq20mdpRRRXedAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFc144IGk25JwPtA/wDQWrpax/EX/Htb/wDXb/2Vq5sZU9nQlK2yHGHtGo33PPPMT+8v50eYn95fzrp6K+T/ALV/unT/AGSv5jmPMT+8v50eYn95fzrp6KP7V/u/iH9kr+Y5jzE/vL+dHmJ/eX866eij+1f7v4h/ZK/mOY8xP7y/nR5if3l/Ounoo/tX+7+If2Sv5jmPMT+8v50eYn95fzrp6KP7V/u/iH9kr+Y5jzE/vL+ddN4GKm/vMEH90nT6mitTw+M3s/8A1zX+Zrsy/H+1xEYctrkTy5UVz817HQ0UUV9SYBRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAVjeJXWO0gZ2CjzupP+y1bNc541/5Btv8A9dx/6C1cuNhz0JR8jbDK9WK8zI+1Qf8APZP++qPtUH/PZP8AvqsaivkPqEe59D7LzNn7VB/z2T/vqj7VB/z2T/vqsaij6hHuHsvM2ftUH/PZP++qPtUH/PZP++qxqKPqEe4ey8zZ+1Qf89k/76o+1Qf89k/76rGoo+oR7h7LzNn7VB/z2T/vqj7VB/z2T/vqsaij6hHuHsvM2ftUH/PZPzrW8NSpLe3Gx1bEa5wfc1yFdH4L/wCP67/65J/M13ZbhFTxMZXvY5sZTtRbudhRRRX1Z4IUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFc540/5BtuP+m4/9BaujrkviMSNCt8Ej/SV6H/ZapdJ1l7NddCoVfZSVR9DmeaOawN7f3m/Oje395vzrH/V6p/Oju/t2H8rN/mjmsDe395vzo3t/eb86P9Xqn86D+3Yfys3+aOawN7f3m/Oje395vzo/1eqfzoP7dh/Kzf5o5rA3t/eb86N7f3m/Oj/V6p/Og/t2H8rN/mjmsDe395vzo3t/eb86P9Xqn86D+3Yfys3+a6LwX/x/3f8A1yT+Zrz7e395vzrsfhuxOoX4JJ/dR9Tnu1VHJp4Z+1ck0uhnVzaFeDpqNmz0GiiitjjCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigArkviN/yArf/AK+V/wDQWrra57xlpF1rOlQwWSo0iThyHbbxtYf1FaUJKNRN7XIqJuLSPLaK6D/hBNd/542//f7/AOtR/wAIJrv/ADxt/wDv9/8AWr2vrFL+ZHB7KfY5+iug/wCEE13/AJ42/wD3+/8ArUf8IJrv/PG3/wC/3/1qPrFL+ZB7KfY5+iug/wCEE13/AJ42/wD3+/8ArUf8IJrv/PG3/wC/3/1qPrFL+ZB7KfY5+iug/wCEE13/AJ42/wD3+/8ArUf8IJrv/PG3/wC/3/1qPrFL+ZB7KfY5+iug/wCEE13/AJ42/wD3+/8ArUf8IJrv/PG3/wC/3/1qPrFL+ZB7KfY5+uy+G3/IQ1D/AK5R/wA2rN/4QTXP+eNv/wB/v/rV0ngvw9qGi3V3JfJEqyIirsk3HgnP8xXPia1OVJpNNmlGnJTTaOvoooryTuCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACuY17xJd6Xqf2a3jgZPLV8uDnkn0PtXT1wXjD/AJD5/wCuCfzasMRNwhdOxnUbUbok/wCE11L/AJ4Wv5N/jR/wmupf88LX8m/xrn6K8/6zU7nP7WXc6D/hNdS/54Wv5N/jR/wmupf88LX8m/xrn6KPrNTuHtZdzoP+E11L/nha/k3+NH/Ca6l/zwtfyb/Gufoo+s1O4e1l3Og/4TXUv+eFr+Tf40f8JrqX/PC1/Jv8a5+ij6zU7h7WXc6D/hNdS/54Wv5N/jR/wmuo/wDPC1/Jv8a5+ij6zU7h7WXc62y8TX11CXMdupDYwA3+NWP7evf7tv8Akf8AGsHSf+PVv981erwK+Z4qNWUVPZn0FChTlSjJrVmh/b17/dt/yP8AjR/b17/dt/yP+NZ9FY/2ri/5zb6rS7Gh/b17/dt/yP8AjR/b17/dt/yP+NZ9FH9q4v8AnD6rS7Gh/b17/dt/yP8AjR/b17/dt/yP+NZ9FH9q4v8AnD6rS7Gj/b15/dg/75P+NZY8Z6gQD5Nrz7N/jUg6iudj+4K7sHmGJqX5pbGlPCUZN3idB/wmOo/88bX8m/xo/wCEx1H/AJ42v5N/jWDRXd9crfzGv1Kh/Kb3/CY6j/zxtfyb/Gj/AITHUf8Anja/k3+NYNFH1yt/MH1Kh/Kb3/CY6j/zxtfyb/Gj/hMdR/542v5N/jWDRR9crfzB9Sofym9/wmOo/wDPG1/Jv8aP+Ex1H/nja/k3+NYNFH1yt/MH1Kh/KXpviFqcVxJGtrZkK2ATu5/Wmf8ACxdU/wCfSz/8e/xrmLr/AI/J/wDf/oKjr7TC4enOjCUldtXZ8jiKkoVZRi9E7HV/8LG1T/n0s/8Ax7/Gj/hY2qf8+ln/AOPf41ylFdH1Sj2MfbT7nV/8LG1T/n0s/wDx7/Gj/hY2qf8APpZ/+Pf41ylFH1Sj2D20+51f/CxtU/59LP8A8e/xo/4WNqn/AD6Wf/j3+NcpRR9Uo9g9tPudX/wsbVP+fSz/APHv8aD8RtUwf9Es/wDx7/GuUpD0P0pfVKPYPbT7ntWm3LXumWty4VXmhSQgdASuf61aqhoX/IA07/r2j/8AQRV+vFe56C2CiiikMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigArA1nwx/a199p+1GI7Am0Ju6Z9/et+iplBTVmhNJqzOR/4QU/9BE/9+R/jR/wgh/6CJ/78j/GuuorL6vT7Eezj2OR/wCEEP8A0ET/AN+R/jR/wgh/6CJ/78j/ABrrqKPq9PsP2cexyP8Awgh/6CJ/78j/ABo/4QQ/9BE/9+R/jXXUUfV6fYPZx7HI/wDCCH/oIn/vyP8AGj/hBD/0ET/35H+NddRR9Xp9g9nHscj/AMIIf+gif+/I/wAaP+EEP/QRP/fkf4111FH1en2D2cexzlr4UNrEUF6WyckmL/69S/8ACOP/AM/Y/wC/X/163aK55ZZhZNtw1Z0Rr1IpRT0Rh/8ACOP/AM/Y/wC/X/16P+Ecf/n7H/fr/wCvW5mjNT/ZOE/k/Mr61V7mH/wjj/8AP2P+/X/16P8AhHH/AOfsf9+v/r1uZozR/ZOE/k/MPrVXuYf/AAjj/wDP2P8Av1/9ej/hHH/5+x/36/8Ar1uZozR/ZOE/kD61V7mJ/wAI6/8Az9j/AL9f/XrPHgggYF+cf9ch/jXV80VdPLsNC/LGw1i6y2kcr/whB/5/z/36H+NH/CEH/n/P/fof411eTRk1p9TofylfXa/8xyn/AAhB/wCf8/8Afof40f8ACEH/AJ/z/wB+h/jXV5NGTR9Tofyh9dr/AMxyn/CEH/n/AD/36H+NH/CEH/n/AD/36H+NdXk0ZNH1Oh/KH12v/Mcp/wAIQf8An/P/AH6H+NH/AAhB/wCf8/8Afof411eTRk0fU6H8ofXa/wDMcRL8OVlmeT+03BY5I8kf40z/AIVov/QVf/vyP8a7nNHeu+GIqQioxeiOKVOM25Nas4b/AIVov/QUf/vyP8aX/hWi/wDQUf8A78j/ABruaKr61V7k+xh2OG/4Vov/AEFH/wC/I/xo/wCFaL/0FH/78j/Gu5op/WqvcPYw7HDf8K0X/oKP/wB+R/jR/wAK0X/oKP8A9+R/jXc0UfWqvcPYw7HDf8K0X/oKP/35H+NIfhovP/E0f/vyP8a7qil9aq9w9jDsV7G2FlY29qGL+TEse49TgYz+lWKKKwvc1CiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9k=)
"""

df.images.shape

df.images[0]

df.images[0].shape

len(df.images)

n_samples = len(df.images)
data= df.images.reshape((n_samples, -1))

data[0]

data[0].shape

data.shape

"""# **Scaling Image Data**"""

data.min()

data.max()

data=data/16

data.min()

data.max()

data[0]

"""# **Train Test Split Data**"""

from sklearn.model_selection import train_test_split

X_train,X_test, y_train, y_test = train_test_split(data, df.target, test_size=0.3)

X_train.shape, X_test.shape, y_train.shape, y_test.shape

"""# **Random Forest Model**"""

from sklearn.ensemble import RandomForestClassifier

rf= RandomForestClassifier()

rf.fit(X_train, y_train)

"""# **Predict Test Data**"""

y_pred = rf.predict(X_test)

y_pred

"""# **Model Accuracy**"""

from sklearn.metrics import confusion_matrix, classification_report

confusion_matrix(y_test, y_pred)

print(classification_report(y_test, y_pred))